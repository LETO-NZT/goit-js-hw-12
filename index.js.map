{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49580419-995b76e467c7e33d07d0013ac';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  try {\n    console.log(`Fetching images: query=${query}, page=${page}, perPage=${perPage}`);\n\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: perPage,\n      },\n    });\n\n    if (!response.data || !response.data.hits) {\n      throw new Error('Invalid API response');\n    }\n\n    console.log(`Fetched ${response.data.hits.length} images.`);\n\n    return {\n      images: response.data.hits,\n      total: response.data.totalHits,\n    };\n\n  } catch (error) {\n    console.error('Error fetching images:', error.message);\n    throw error;\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\n\nif (!gallery) {\n  console.error(\"Error: '.gallery' element not found!\");\n}\nif (!loader) {\n  console.error(\"Error: '.loader' element not found!\");\n}\n\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport function showLoader(underButton = false) {\n  if (!loader) return;\n\n  if (underButton) {\n    loader.classList.add(\"loader--under-button\");\n  } else {\n    loader.classList.remove(\"loader--under-button\");\n  }\n  loader.style.display = \"block\";\n}\n\nexport function hideLoader() {\n  if (!loader) return;\n  loader.style.display = \"none\";\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\n\nexport function renderImages(images) {\n  if (!images || images.length === 0) {\n    iziToast.error({\n      message: \"Sorry, there are no images matching your search query. Please try again!\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  const markup = images\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n      const truncatedTags = tags.split(\", \").slice(0, 3).join(\", \");\n      return `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\" data-caption=\"${truncatedTags}\">\n          <img src=\"${webformatURL}\" alt=\"${truncatedTags}\" loading=\"lazy\" class=\"gallery-image\">\n        </a>\n        <div class=\"info\">\n          <p><b>Likes</b> ${likes}</p>\n          <p><b>Views</b> ${views}</p>\n          <p><b>Comments</b> ${comments}</p>\n          <p><b>Downloads</b> ${downloads}</p>\n        </div>\n      </li>`;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n};\n","import { fetchImages } from './js/pixabay-api';\nimport { renderImages, clearGallery, showLoader, hideLoader } from './js/render-functions.js';\nimport iziToast from 'izitoast'; \n\nfunction init() {\n  const form = document.querySelector(\".form\");\n  // const input = document.querySelector(\"input[name='search-input']\");\n  const input = document.getElementById(\"search-input\");\n\n  const loadMoreBtn = document.querySelector(\".load-more\");\n\n  if (!form || !input) {\n    console.error(\"Не найдены необходимые элементы формы.\");\n    return;\n  }\n\n  let currentPage = 1;\n  let currentQuery = '';\n  const perPage = 15;\n  let totalHits = 0;\n\n  form.addEventListener(\"submit\", async event => {\n    event.preventDefault();\n    currentQuery = input.value.trim();\n    currentPage = 1;\n\n    if (!currentQuery) {\n      iziToast.warning({\n        message: \"Please enter a search query!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    clearGallery();\n    hideLoadMoreBtn();\n    showLoader();\n\n    try {\n      const response = await fetchImages(currentQuery, currentPage, perPage);\n      const images = response.images;\n      totalHits = response.total;\n\n      if (!images.length) {\n        iziToast.error({\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          position: \"topRight\",\n        });\n        return;\n      }\n\n      renderImages(images);\n\n      if (totalHits > perPage) {\n        showLoadMoreBtn();\n      }\n    } catch (error) {\n      iziToast.error({\n        message: \"Something went wrong. Please try again later.\",\n        position: \"topRight\",\n      });\n    } finally {\n      hideLoader();\n      input.value = \"\";\n    }\n  });\n\n  loadMoreBtn.addEventListener(\"click\", async () => {\n    currentPage += 1;\n    showLoader(true);\n\n    try {\n      const response = await fetchImages(currentQuery, currentPage, perPage);\n      const images = response.images;\n\n      renderImages(images);\n      smoothScroll();\n\n      const imagesLoaded = currentPage * perPage;\n      if (imagesLoaded >= totalHits) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: \"topRight\",\n        });\n        hideLoadMoreBtn();\n      }\n    } catch (error) {\n      iziToast.error({\n        message: \"Error loading more images.\",\n        position: \"topRight\",\n      });\n    } finally {\n      hideLoader();\n    }\n  });\n\n  function showLoadMoreBtn() {\n    loadMoreBtn.hidden = false;\n  }\n\n  function hideLoadMoreBtn() {\n    loadMoreBtn.hidden = true;\n  }\n\n  function smoothScroll() {\n    const { height: cardHeight } = document\n      .querySelector(\".gallery\")\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: \"smooth\",\n    });\n  }\n}\n\n\ndocument.addEventListener('DOMContentLoaded', init);\n\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","response","axios","error","gallery","loader","lightbox","SimpleLightbox","showLoader","underButton","hideLoader","clearGallery","renderImages","images","iziToast","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","truncatedTags","init","form","input","loadMoreBtn","currentPage","currentQuery","totalHits","event","hideLoadMoreBtn","showLoadMoreBtn","smoothScroll","cardHeight"],"mappings":"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"}